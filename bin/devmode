#!/usr/bin/env bash
#=|
#=| DESCRIPTION
#%|   Utility to configure development mode
#=|
#+| USAGE
#+|   devmode [-h] [identifier]
#+|
#+| ARGUMENTS
#+|   identifier    (Optional) Configuration file identifier
#+|
#+| OPTIONS
#+|   -h            Print this help message
#+|
#+| EXAMPLES
#+|   devmode               // removes .environment file
#+|   devmode dev@home      // set .environment file value
#=|
#-| AUTHORING
#-|   author          @jeslopalo <Jesús López Alonso>
#-|   year            2018
#=|
source $(dirname $(sourcedir "$BASH_SOURCE"))/.rc

source $DEVKIT_LIB/usage.lib.sh

if [[ ${1:-} = "-h" ]]; then
    usage
    exit 0
fi

if [ "$#" = 0 ]; then
    printf "Removing .environment file ([$DEVKIT_HOME/config/config.json] will be used)...\\n"
    [ -f "$DEVKIT_HOME/.environment" ] && rm "$DEVKIT_HOME/.environment"
    exit 0
fi

if [ "$#" = 1 ]; then
    printf "Creating .environment file with '%s' name ([$DEVKIT_HOME/config/config-%s.json] will be used)...\\n" "$1" "$1"
    [ -f "$DEVKIT_HOME/.environment" ] && rm "$DEVKIT_HOME/.environment"
    echo "$1" > "$DEVKIT_HOME/.environment"
    exit 0
fi

printf "usage: devmode <environment_name>\\n"
exit 1
